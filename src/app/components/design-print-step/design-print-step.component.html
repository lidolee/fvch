<ng-container *ngIf="produktionState$ | async as produktion">
  <div class="step-intro">
    <p class="step-title">Design & Druck</p>
    <h2>Benötigen Sie Flyer Druck und Design?</h2>
    <p>Wählen Sie Ihre Druckoptionen und Designpaket.</p>
  </div>
  
  <h3 class="section-title mt-4"><span>1. Druck & Anlieferung</span></h3>
  
  <div class="choice-card-group">
    <button type="button" class="choice-card" [class.active]="produktion.printOption === 'anliefern'" (click)="onPrintOptionSelect('anliefern')">
      <i class="mdi mdi-truck-delivery card-icon"></i>
      <span class="card-content">
        <span class="card-title">Flyer vorhanden</span>
        <span class="card-description">Kostenlos</span>
      </span>
      <span class="card-indicator"></span>
    </button>
    
    <button type="button" class="choice-card" [class.active]="produktion.printOption === 'service'" (click)="onPrintOptionSelect('service')">
      <i class="mdi mdi-printer card-icon"></i>
      <span class="card-content">
        <span class="card-title">Druck Service nutzen</span>
        <span class="card-description">Wir drucken ihre Flyer</span>
      </span>
      <span class="card-indicator"></span>
    </button>
  </div>
  
  <div *ngIf="produktion.printOption === 'anliefern'" class="mt-4">
    
    <div class="alert alert-light mt-0" role="alert">
      <div class="d-flex align-items-center mb-2"><span class="alert-title"><i class="mdi mdi-alert-box me-2 fs-5"></i>Hinweise</span></div>
      <ul>
        <li>Grosse Formate verursachen bei der Verteilung zusätzlichen Aufwand in der Logistik.<br><i class="mdi mdi-arrow-right-thin"></i>&nbsp;Deshalb erheben wir für die Verteilung einen <strong>pauschalen Zuschlag pro 1'000 Flyer.</strong></li>
        <li>Berechnungsgrundlage ist das <strong>Endformat im aufgeklappten/ungefalteten Zustand</strong><br><i class="mdi mdi-arrow-right-thin"></i>&nbsp;Beispiel: Ein gefalteter A4-Flyer auf A5 Format <strong>wird als A4 berechnet.</strong></li>
      </ul>
    </div>
    
    <fieldset class="mt-3">
      <legend><span>Flyer Format</span></legend>
      <div class="choice-card-group">
        <button type="button" class="choice-card"
                [class.active]="produktion.anlieferDetails.format === 'A6'"
                (click)="onFormatSelect('A6', false)">
          <i class="mdi mdi-invoice-text card-icon"></i>
          <span class="card-content"><span class="card-title">A6</span><span class="card-description">Kein Zuschlag</span></span>
          <span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card"
                [class.active]="produktion.anlieferDetails.format === 'A5'"
                (click)="onFormatSelect('A5', false)">
          <i class="mdi mdi-invoice-text card-icon"></i>
          <span class="card-content"><span class="card-title">A5</span><span class="card-description">Kein Zuschlag</span></span>
          <span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card"
                [class.active]="produktion.anlieferDetails.format === 'A4'"
                (click)="onFormatSelect('A4', false)">
          <i class="mdi mdi-invoice-text card-icon"></i>
          <span class="card-content"><span class="card-title">A4</span><span class="card-description">+ CHF 30 / 1'000 Flyer</span></span>
          <span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card"
                [class.active]="produktion.anlieferDetails.format === 'A3'"
                (click)="onFormatSelect('A3', false)">
          <i class="mdi mdi-invoice-text card-icon"></i>
          <span class="card-content"><span class="card-title">A3</span><span class="card-description">+ CHF 50 / 1'000 Flyer</span></span>
          <span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card"
                [class.active]="produktion.anlieferDetails.format === 'DIN-Lang'"
                (click)="onFormatSelect('DIN-Lang', false)">
          <i class="mdi mdi-invoice-text card-icon"></i>
          <span class="card-content"><span class="card-title">DIN Lang</span><span class="card-description">+ CHF 20 / 1'000 Flyer</span></span>
          <span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card"
                [class.active]="produktion.anlieferDetails.format === 'Anderes Format'" (click)="onFormatSelect('Anderes Format', false)">
          <i class="mdi mdi-invoice-text card-icon"></i>
          <span class="card-content"><span class="card-title">Anderes Format</span><span class="card-description">Wird separat offeriert</span></span>
          <span class="card-indicator"></span>
        </button>
      </div>
    </fieldset>
    
    <fieldset class="mt-3">
      <legend><span>Anlieferung der Flyer</span></legend>
      <div class="choice-card-group">
        <button type="button" class="choice-card"
                [class.active]="produktion.anlieferDetails.anlieferung === 'selbst'"
                (click)="onAnlieferungSelect('selbst')">
          <i class="mdi mdi-package-check card-icon"></i>
          <span class="card-content">
            <span class="card-title">Sie liefern zu uns</span>
            <span class="card-description">kostenlos</span>
          </span>
          <span class="card-indicator"></span>
        </button>
        
        <button type="button" class="choice-card"
                [class.active]="produktion.anlieferDetails.anlieferung === 'abholung'"
                (click)="onAnlieferungSelect('abholung')">
          <i class="mdi mdi-truck-fast card-icon"></i>
          <span class="card-content">
            <span class="card-title">Wir holen ab</span>
            <span class="card-description">+ CHF 50</span>
          </span>
          <span class="card-indicator"></span>
        </button>
      </div>
    </fieldset>
  </div>
  
  <div *ngIf="produktion.printOption === 'service'" class="mt-4">
    
    <div class="alert alert-light mt-0" role="alert">
      <div class="d-flex align-items-center mb-2"><span class="alert-title"><i class="mdi mdi-alert-box me-2 fs-5"></i>Hinweise</span></div>
      <ul>
        <li>Grosse Formate verursachen bei der Verteilung zusätzlichen Aufwand in der Logistik.<br><i class="mdi mdi-arrow-right-thin"></i>&nbsp;Deshalb erheben wir für die Verteilung einen <strong>pauschalen Zuschlag pro 1'000 Flyer.</strong></li>
        <li>Flyer Druck wird separat offeriert und wird in dieser Berechnung nicht berücksichtigt.
          <br><i class="mdi mdi-arrow-right-thin"></i>&nbsp;Die aufgeführten Zuschläge gelten <strong>nur für die Verteilung - nicht für den Druck.</strong>
          <br><i class="mdi mdi-arrow-right-thin"></i>&nbsp;Sie erhalten für den Druck eine <strong>separate Offerte per Mail.</strong>
        </li>
      </ul>
    </div>
    
    <fieldset class="mt-3">
      <legend><span>Flyer Format</span></legend>
      <div class="choice-card-group">
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.format === 'A6'" (click)="onFormatSelect('A6', true)">
          <i class="mdi mdi-invoice-text card-icon"></i><span class="card-content"><span class="card-title">A6</span><span class="card-description">Kein Zuschlag</span></span><span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.format === 'A5'" (click)="onFormatSelect('A5', true)">
          <i class="mdi mdi-invoice-text card-icon"></i><span class="card-content"><span class="card-title">A5</span><span class="card-description">Kein Zuschlag</span></span><span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.format === 'A4'" (click)="onFormatSelect('A4', true)">
          <i class="mdi mdi-invoice-text card-icon"></i><span class="card-content"><span class="card-title">A4</span><span class="card-description">+ CHF 30 / 1'000 Flyer</span></span><span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.format === 'A3'" (click)="onFormatSelect('A3', true)">
          <i class="mdi mdi-invoice-text card-icon"></i><span class="card-content"><span class="card-title">A3</span><span class="card-description">+ CHF 50 / 1'000 Flyer</span></span><span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.format === 'DIN-Lang'" (click)="onFormatSelect('DIN-Lang', true)">
          <i class="mdi mdi-invoice-text card-icon"></i><span class="card-content"><span class="card-title">DIN Lang</span><span class="card-description">+ CHF 20 / 1'000 Flyer</span></span><span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.format === 'Anderes Format'" (click)="onFormatSelect('Anderes Format', true)">
          <i class="mdi mdi-invoice-text card-icon"></i><span class="card-content"><span class="card-title">Anderes Format</span><span class="card-description">Wird separat offeriert</span></span><span class="card-indicator"></span>
        </button>
      </div>
    </fieldset>
    
    <fieldset class="mt-3">
      <legend><span>Grammatur</span></legend>
      <div class="choice-card-group">
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.grammatur === '90'" (click)="setDruckGrammatur('90')">
          <i class="mdi mdi-format-line-weight card-icon"></i><span class="card-content"><span class="card-title">90g/m²</span><span class="card-description">Budget Flyer</span></span><span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.grammatur === '115'" (click)="setDruckGrammatur('115')">
          <i class="mdi mdi-format-line-weight card-icon"></i><span class="card-content"><span class="card-title">115g/m²</span><span class="card-description">Standard Flyer</span></span><span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.grammatur === '130'" (click)="setDruckGrammatur('130')">
          <i class="mdi mdi-format-line-weight card-icon"></i><span class="card-content"><span class="card-title">130g/m²</span><span class="card-description">Werbeflyer mit Anspruch</span></span><span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.grammatur === '170'" (click)="setDruckGrammatur('170')">
          <i class="mdi mdi-format-line-weight card-icon"></i><span class="card-content"><span class="card-title">170g/m²</span><span class="card-description">Für längere Haltbarkeit</span></span><span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.grammatur === '250'" (click)="setDruckGrammatur('250')">
          <i class="mdi mdi-format-line-weight card-icon"></i><span class="card-content"><span class="card-title">250g/m²</span><span class="card-description">Stabil & hochwertig</span></span><span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.grammatur === '300'" (click)="setDruckGrammatur('300')">
          <i class="mdi mdi-format-line-weight card-icon"></i><span class="card-content"><span class="card-title">300g/m²</span><span class="card-description">Exklusive premium Karten</span></span><span class="card-indicator"></span>
        </button>
      </div>
    </fieldset>
    
    <fieldset class="mt-3">
      <legend><span>Druckart</span></legend>
      <div class="choice-card-group">
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.art === 'einseitig'" (click)="setDruckArt('einseitig')">
          <i class="mdi mdi-book-open-blank-variant card-icon"></i><span class="card-content"><span class="card-title">Einseitig</span><span class="card-description">Vorne bedruckt</span></span><span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.art === 'zweiseitig'" (click)="setDruckArt('zweiseitig')">
          <i class="mdi mdi-book-open-blank-variant-outline card-icon"></i><span class="card-content"><span class="card-title">Zweiseitig</span><span class="card-description">Vorne und Hinten bedruckt</span></span><span class="card-indicator"></span>
        </button>
      </div>
    </fieldset>
    
    <fieldset class="mt-3">
      <legend><span>Ausführung</span></legend>
      <div class="choice-card-group">
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.ausfuehrung === 'glaenzend'" (click)="setDruckAusfuehrung('glaenzend')">
          <i class="mdi mdi-creation card-icon"></i><span class="card-content"><span class="card-title">Glänzend gestrichen</span><span class="card-description">Farbstark mit Glanz</span></span><span class="card-indicator"></span>
        </button>
        <button type="button" class="choice-card" [class.active]="produktion.printServiceDetails.ausfuehrung === 'matt'" (click)="setDruckAusfuehrung('matt')">
          <i class="mdi mdi-star-four-points card-icon"></i><span class="card-content"><span class="card-title">Matt gestrichen</span><span class="card-description">Matt & edel</span></span><span class="card-indicator"></span>
        </button>
      </div>
    </fieldset>
  </div>
  
  <div *ngIf="produktion.printOption === 'service'">
    <h3 class="section-title"><span>2. Flyer Design</span></h3>
    
    
    <div class="choice-card-group design-package-group">
      
      <div class="choice-card clickable-card design-package" [class.selected]="produktion.designPackage === 'eigenes'" (click)="onDesignPackageSelect('eigenes')">
        <div class="card-header">
          <i class="package-icon mdi mdi-palette"></i>
          <h5 class="package-name">Eigenes Design</h5>
          <p class="package-slogan">Sie haben bereits ein Design</p>
          <p class="package-price">Kostenlos</p>
        </div>
        <div class="card-body">
          <ul class="features list-unstyled">
            <li *ngIf="produktion.printOption === 'service'"><i class="mdi mdi-star-four-points-small"></i> Sie liefern ein druckfertiges PDF</li>
            <li><i class="mdi mdi-star-four-points-small"></i> Swiss Quality-Check</li>
          </ul>
        </div>
        <i *ngIf="produktion.designPackage === 'eigenes'" class="mdi mdi-check-circle selected-indicator-package"></i>
      </div>
      
      <div class="choice-card clickable-card design-package" [class.selected]="produktion.designPackage === 'basis'" (click)="onDesignPackageSelect('basis')">
        <div class="card-header">
          <i class="package-icon mdi mdi-package"></i>
          <h5 class="package-name">Basis Paket</h5>
          <p class="package-slogan">Für hochwertige Designs</p>
          <p class="package-price">CHF 399</p>
          <p class="package-price-old">statt CHF 449</p>
        </div>
        <div class="card-body">
          <ul class="features list-unstyled">
            <li><i class="mdi mdi-star-four-points-small"></i> 1 Designvorschlag</li>
            <li><i class="mdi mdi-star-four-points-small"></i> 1 Korrektur</li>
            <li><i class="mdi mdi-star-four-points-small"></i> Druckfähiges PDF</li>
            <li><i class="mdi mdi-star-four-points-small"></i> Swiss Quality-Check</li>
            <li><i class="mdi mdi-star-four-points-small"></i> <span class="savings-info">Sie sparen CHF 50</span></li>
          </ul>
        </div>
        <i *ngIf="produktion.designPackage === 'basis'" class="mdi mdi-check-circle selected-indicator-package"></i>
      </div>
      
      <div class="choice-card clickable-card design-package bestseller" [class.selected]="produktion.designPackage === 'plus'" (click)="onDesignPackageSelect('plus')">
        <div class="card-header">
          <i class="package-icon mdi mdi-package"></i>
          <h5 class="package-name">Plus Paket <span class="badge text-bg-secondary bestseller-badge">Bestseller</span></h5>
          <p class="package-slogan">Für KMU mit Designanspruch</p>
          <p class="package-price">CHF 899</p>
          <p class="package-price-old">statt CHF 999</p>
        </div>
        <div class="card-body">
          <ul class="features list-unstyled">
            <li><i class="mdi mdi-star-four-points-small"></i> 2 Designvorschläge</li>
            <li><i class="mdi mdi-star-four-points-small"></i> 3 Korrekturen</li>
            <li><i class="mdi mdi-star-four-points-small"></i> Druckfähiges PDF</li>
            <li><i class="mdi mdi-star-four-points-small"></i> Swiss Quality-Check</li>
            <li><i class="mdi mdi-star-four-points-small"></i> Quelldateien inklusive</li>
            <li><i class="mdi mdi-star-four-points-small"></i> <span class="savings-info">Sie sparen CHF 100</span></li>
          </ul>
        </div>
        <i *ngIf="produktion.designPackage === 'plus'" class="mdi mdi-check-circle selected-indicator-package"></i>
      </div>
      
      <div class="choice-card clickable-card design-package" [class.selected]="produktion.designPackage === 'premium'" (click)="onDesignPackageSelect('premium')">
        <div class="card-header">
          <i class="package-icon mdi mdi-package"></i>
          <h5 class="package-name">Premium Paket</h5>
          <p class="package-slogan">Für starkes Marketing</p>
          <p class="package-price">CHF 1’999</p>
          <p class="package-price-old">statt CHF 2’499</p>
        </div>
        <div class="card-body">
          <ul class="features list-unstyled">
            <li><i class="mdi mdi-star-four-points-small"></i> 3 Designvorschläge</li>
            <li><i class="mdi mdi-star-four-points-small"></i> 5 Korrekturen</li>
            <li><i class="mdi mdi-star-four-points-small"></i> Druckfähiges PDF</li>
            <li><i class="mdi mdi-star-four-points-small"></i> Swiss Quality-Check</li>
            <li><i class="mdi mdi-star-four-points-small"></i> Quelldateien inklusive</li>
            <li><i class="mdi mdi-star-four-points-small"></i> Logo & Branding Beratung</li>
            <li><i class="mdi mdi-star-four-points-small"></i> Marketing-Strategie</li>
            <li><i class="mdi mdi-star-four-points-small"></i> <span class="savings-info">Sie sparen CHF 500</span></li>
          </ul>
        </div>
        <i *ngIf="produktion.designPackage === 'premium'" class="mdi mdi-check-circle selected-indicator-package"></i>
      </div>
    </div>
  </div>
</ng-container>
